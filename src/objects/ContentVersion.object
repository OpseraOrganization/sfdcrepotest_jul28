<?xml version="1.0" encoding="UTF-8"?>
<CustomObject xmlns="http://soap.sforce.com/2006/04/metadata">
    <validationRules>
        <fullName>CH_Default_Sharing_to_Freeze</fullName>
        <active>true</active>
        <errorConditionFormula>ISPICKVAL(SharingOption, &apos;Freeze Sharing Off&apos;) &amp;&amp;  Internal_Only__c = true &amp;&amp;  RecordType.Name = &apos;CH_Knowledge_Content_Version&apos;</errorConditionFormula>
        <errorDisplayField>SharingOption</errorDisplayField>
        <errorMessage>Please freeze content sharing, file marked as internal only.</errorMessage>
    </validationRules>
    <validationRules>
        <fullName>CQ_DocTypeUpdate_Restrict</fullName>
        <active>true</active>
        <description>Document Type field update must be restricted when it&apos;s value is either &apos;Surround Documenr&apos; or &apos;Quote Document&apos;.</description>
        <errorConditionFormula>AND(  
NOT( 
$Profile.Name = &apos;Data Loader Profile&apos; 
), 
OR( ISPICKVAL(PRIORVALUE( Document_Type_POC__c ),&apos;Surround Document&apos;), ISPICKVAL(PRIORVALUE( Document_Type_POC__c ),&apos;Quote Document&apos;) ), ISCHANGED(Document_Type_POC__c) 
)</errorConditionFormula>
        <errorMessage>You cannot change the document type.</errorMessage>
    </validationRules>
    <validationRules>
        <fullName>Restrict_Document_Type_Update</fullName>
        <active>true</active>
        <description>User can&apos;t change/Update Doc Type on file</description>
        <errorConditionFormula>AND(
NOT($RecordType.DeveloperName = &quot;Unrestricted_File_to_Other&quot;), 
NOT( 
$Profile.Name = &apos;Data Loader Profile&apos; 
),
 ISCHANGED(  Document_Type_POC__c ) 
)</errorConditionFormula>
        <errorDisplayField>Document_Type_POC__c</errorDisplayField>
        <errorMessage>You cannot change the document type once a file is uploaded. Please upload new file.</errorMessage>
    </validationRules>
    <validationRules>
        <fullName>Restrict_Offer_G4_G5_template_Upload</fullName>
        <active>false</active>
        <description>G4 / G5 LoA template cannot uploaded via UI on Offer</description>
        <errorConditionFormula>AND(
NOT( 
OR($Profile.Name = &apos;Data Loader Profile&apos; ,
$Profile.Name = &apos;Excel Add-In Profile&apos;  
)
),
OR(
ISPICKVAL(Document_Type_POC__c , &apos;LoA G4 Template&apos;),
ISPICKVAL(Document_Type_POC__c , &apos;LoA G5 Template&apos;)
) 
)</errorConditionFormula>
        <errorDisplayField>Document_Type_POC__c</errorDisplayField>
        <errorMessage>LoA G4/G5 Template can only be uploaded with LoA Excel Add-in.</errorMessage>
    </validationRules>
</CustomObject>
