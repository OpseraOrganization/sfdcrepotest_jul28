<?xml version="1.0" encoding="UTF-8"?>
<CustomObject xmlns="http://soap.sforce.com/2006/04/metadata">
    <validationRules>
        <fullName>CH_CPA_AssignOnlyCPAManager</fullName>
        <active>true</active>
        <errorConditionFormula>AND(
ISPICKVAL(CH_CPA_Status__c,&quot;Assigned&quot;),
	$User.Id &lt;&gt; CH_CPA_Manager__r.Id
				)</errorConditionFormula>
        <errorDisplayField>CH_CPA_Status__c</errorDisplayField>
        <errorMessage>You are not allowed to assign the CPA as you are not the Manager</errorMessage>
    </validationRules>
    <validationRules>
        <fullName>CH_CPA_CancelledFromCreated_Only</fullName>
        <active>true</active>
        <description>If a cancel is requested for other status that created actions , error message &apos; only Created actions could be cancelled, the other actions should be closed&quot;</description>
        <errorConditionFormula>AND(
ISCHANGED(CH_CPA_Status__c),
 ISPICKVAL(CH_CPA_Status__c,&quot;Cancelled&quot;) ,
NOT(TEXT(PRIORVALUE(CH_CPA_Status__c))=&quot;Created&quot;)
)</errorConditionFormula>
        <errorDisplayField>CH_CPA_Status__c</errorDisplayField>
        <errorMessage>Only Created actions could be Cancelled, The other actions should be closed</errorMessage>
    </validationRules>
    <validationRules>
        <fullName>CH_CPA_CancelledOnlyCPAManager</fullName>
        <active>true</active>
        <description>https://yoursl.atlassian.net/browse/NOKIASC-20143</description>
        <errorConditionFormula>AND(
ISPICKVAL(CH_CPA_Status__c,&quot;Cancelled&quot;),
$User.Id &lt;&gt; CH_CPA_Manager__r.Id
)</errorConditionFormula>
        <errorDisplayField>CH_CPA_Status__c</errorDisplayField>
        <errorMessage>You are not allowed to cancel the CPA as you are not the Manager</errorMessage>
    </validationRules>
    <validationRules>
        <fullName>CH_CPA_ClosedActionStatus</fullName>
        <active>true</active>
        <errorConditionFormula>AND(
ISPICKVAL(CH_CPA_Status__c,&quot;Closed&quot;),
$User.Id &lt;&gt; CH_CPA_Manager__r.Id
)</errorConditionFormula>
        <errorDisplayField>CH_CPA_Status__c</errorDisplayField>
        <errorMessage>You are not allowed to close the CPA as you are not the Manager</errorMessage>
    </validationRules>
    <validationRules>
        <fullName>CH_CPA_ClosedStage_Validation</fullName>
        <active>true</active>
        <errorConditionFormula>AND ( 
ISPICKVAL(CH_CPA_Status__c,&quot;Closed&quot;),
				
ISPICKVAL(CH_Process_Stage__c,&quot;Close&quot;),
				
ISPICKVAL( CH_Closed_Reason__c, &quot;&quot;)
	
)</errorConditionFormula>
        <errorDisplayField>CH_Closed_Reason__c</errorDisplayField>
        <errorMessage>Please update Closed Reason</errorMessage>
    </validationRules>
    <validationRules>
        <fullName>CH_CPA_Created_IdentifyCreateNewCPA</fullName>
        <active>true</active>
        <errorConditionFormula>AND(ISNEW(),
NOT(ISPICKVAL(CH_Process_Stage__c, &apos;Identify -Create&apos;))
	)</errorConditionFormula>
        <errorDisplayField>CH_Process_Stage__c</errorDisplayField>
        <errorMessage>Process Stage should be Identify-Create for a New CPA</errorMessage>
    </validationRules>
    <validationRules>
        <fullName>CH_CPA_Created_NewCPA</fullName>
        <active>true</active>
        <errorConditionFormula>AND(ISNEW(),
			NOT(ISPICKVAL(CH_CPA_Status__c, &apos;Created&apos;))
				
				)</errorConditionFormula>
        <errorDisplayField>CH_CPA_Status__c</errorDisplayField>
        <errorMessage>Status should be Created for a New CPA</errorMessage>
    </validationRules>
    <validationRules>
        <fullName>CH_CPA_IdentifyStatus_Validation</fullName>
        <active>true</active>
        <errorConditionFormula>OR(
				
					AND ( ISPICKVAL( CH_Process_Stage__c, &quot;Identify&quot;),
										  ISPICKVAL( CH_Source__c, &quot;&quot;) 
									)
    ,
			
 				AND ( ISPICKVAL( CH_Process_Stage__c, &quot;Identify&quot;),
										CH_Cause_Analysis__c=null   
									)
)</errorConditionFormula>
        <errorMessage>Cause Analysis &amp; Source is mandatory on Identify Status</errorMessage>
    </validationRules>
    <validationRules>
        <fullName>CH_CPA_ImplementStatus_Validation</fullName>
        <active>false</active>
        <errorConditionFormula>AND ( ISPICKVAL( CH_Process_Stage__c , &quot;Implement&quot;),
						  OR(
            NOT(CH_Customer_Delivery__c)	,
												ISPICKVAL( CH_Implemented_by__c , &quot;&quot;)  ,
												 CH_Follow_up__c =null,
												 CH_Action_Executed__c =null,  
  												CH_Result__c  =null
										)
				)</errorConditionFormula>
        <errorMessage>Please Complete Customer Delivery,Implemented by,Follow-up ,Action Executed,Result Fields</errorMessage>
    </validationRules>
    <validationRules>
        <fullName>CH_CPA_ImplementToClose_Validation</fullName>
        <active>true</active>
        <errorConditionFormula>AND (
ISPICKVAL( CH_CPA_Status__c , &quot;Performed&quot;),
ISPICKVAL( CH_Process_Stage__c , &quot;Implement&quot;),
(OR(
 
ISPICKVAL( CH_Implemented_by__c , &quot;&quot;) ,
CH_Follow_up__c =null,
CH_Action_Executed__c =null,  
CH_Result__c  =null,
ISBLANK(CH_CPA_Manager__c)
)
)
)</errorConditionFormula>
        <errorMessage>Please Complete Implemented by,Follow-up ,Action Executed,Result .</errorMessage>
    </validationRules>
    <validationRules>
        <fullName>CH_CPA_Implement_Rejected_Validation</fullName>
        <active>true</active>
        <description>Rejection Cause should be provided if CPA Stage is Implement and Status is Rejected</description>
        <errorConditionFormula>AND(  ISPICKVAL(CH_CPA_Status__c, &quot;Rejected&quot;),

 ISPICKVAL(CH_Process_Stage__c , &quot;Implement&quot;), 
 ISPICKVAL(CH_Rejection_Cause__c, &quot;&quot;)

)</errorConditionFormula>
        <errorDisplayField>CH_Rejection_Cause__c</errorDisplayField>
        <errorMessage>Rejection Cause should be provided</errorMessage>
    </validationRules>
    <validationRules>
        <fullName>CH_CPA_ManageCancelledStatus_Validation</fullName>
        <active>true</active>
        <description>Cancellation Cause when status is cancelled and stage is manage</description>
        <errorConditionFormula>AND ( ISPICKVAL( CH_CPA_Status__c , &quot;Cancelled&quot;),
       ISPICKVAL(CH_Process_Stage__c, &quot;Manage&quot;),
       ISPICKVAL( CH_Cancellation_Cause__c , &quot;&quot;)
 
 

)</errorConditionFormula>
        <errorDisplayField>CH_Cancellation_Cause__c</errorDisplayField>
        <errorMessage>Please fill the cancellation cause</errorMessage>
    </validationRules>
    <validationRules>
        <fullName>CH_CPA_ManageStage_Validation</fullName>
        <active>true</active>
        <errorConditionFormula>AND(
ISPICKVAL( CH_CPA_Status__c , &quot;Assigned&quot;),
ISPICKVAL( CH_Process_Stage__c , &quot;Manage&quot;),
ISBLANK(CH_CPA_Manager__c)
)</errorConditionFormula>
        <errorDisplayField>CH_CPA_Manager__c</errorDisplayField>
        <errorMessage>Please provide CPA Manager</errorMessage>
    </validationRules>
    <validationRules>
        <fullName>CH_CPA_ManageToImplement_Mandatory</fullName>
        <active>true</active>
        <errorConditionFormula>AND(
ISPICKVAL( CH_CPA_Status__c , &quot;Assigned&quot;),
ISPICKVAL( CH_Process_Stage__c , &quot;Manage&quot;),
ISBLANK(CH_CPA_Manager__c)
)</errorConditionFormula>
        <errorMessage>Please provide CPA Manager</errorMessage>
    </validationRules>
    <validationRules>
        <fullName>CH_CPA_OnlyOwnerPerformed</fullName>
        <active>true</active>
        <description>CH_CPA_OnlyOwnerPerform</description>
        <errorConditionFormula>AND(
ISPICKVAL(CH_CPA_Status__c,&quot;Performed&quot;),
$User.Id &lt;&gt;  OwnerId
  
)</errorConditionFormula>
        <errorDisplayField>CH_CPA_Status__c</errorDisplayField>
        <errorMessage>You are not allowed to Perform the CPA as you are not the Owner</errorMessage>
    </validationRules>
    <validationRules>
        <fullName>CH_CPA_OwnerRejected_Validation</fullName>
        <active>false</active>
        <description>US-20347: As CPA owner , I want to have the capacity to reject the ownership of the action and fills the rejection cause</description>
        <errorConditionFormula>AND(
NOT(ISPICKVAL(PRIORVALUE(CH_CPA_Status__c), &quot;Rejected&quot;)) , 
ISPICKVAL(CH_CPA_Status__c,&quot;Rejected&quot;),
$User.Id &lt;&gt;  OwnerId

)</errorConditionFormula>
        <errorDisplayField>CH_CPA_Status__c</errorDisplayField>
        <errorMessage>You are not allowed to reject the CPA as you are not the owner</errorMessage>
    </validationRules>
    <validationRules>
        <fullName>CH_CPA_freeTextBox_Mandatory_for_Others</fullName>
        <active>true</active>
        <description>When the value &apos;Other&apos; in the picklist for the different fields of an action, the system proposes to fill &apos; Free text box&apos; field.</description>
        <errorConditionFormula>AND((OR(ISPICKVAL( CH_Source__c , &apos;Other&apos;),ISPICKVAL(CH_Category__c  , &apos;Other&apos;),ISPICKVAL( CH_Sub_category__c  , &apos;Other&apos;),ISPICKVAL(CH_Scope__c , &apos;Other&apos;),ISPICKVAL( CH_Additional_Comms__c  , &apos;Other&apos;),ISPICKVAL( CH_Cancellation_Cause__c   , &apos;Other&apos;),ISPICKVAL( CH_Rejection_Cause__c , &apos;Other&apos;))), ISBLANK( CH_Free_text_box__c ) )</errorConditionFormula>
        <errorDisplayField>CH_Free_text_box__c</errorDisplayField>
        <errorMessage>Please specify the value that misses in the pick-list where you put other thank you.</errorMessage>
    </validationRules>
</CustomObject>
