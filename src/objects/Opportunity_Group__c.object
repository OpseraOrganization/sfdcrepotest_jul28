<?xml version="1.0" encoding="UTF-8"?>
<CustomObject xmlns="http://soap.sforce.com/2006/04/metadata">
    <validationRules>
        <fullName>LockOpptyGroupForPendingApprovalOppty</fullName>
        <active>true</active>
        <description>This validation will lock the deal-opportunity grouping record if opportunity is pending for approval or closed.</description>
        <errorConditionFormula>AND( 
$Profile.Name &lt;&gt; $Label.Data_Loader_Profile_Name, 
OR( 
Opportunity__r.RecordType.DeveloperName == &apos;Direct_Record_Type&apos;, 
Opportunity__r.RecordType.DeveloperName == &apos;Indirect_Record_Type&apos;,
Opportunity__r.RecordType.DeveloperName == &apos;Read_Only&apos;, 
Opportunity__r.RecordType.DeveloperName == &apos;Read_Only_Indirect&apos;
), 
OR( 
ISPICKVAL(Opportunity__r.Phase_Status__c , &apos;Submitted for G2 Approval&apos;), 
ISPICKVAL(Opportunity__r.Phase_Status__c , &apos;Submitted for G3 Approval&apos;), 
ISPICKVAL(Opportunity__r.Phase_Status__c , &apos;Submitted for G4 Approval&apos;), 
ISPICKVAL(Opportunity__r.Phase_Status__c , &apos;Submitted for G5 Approval&apos;), 
ISPICKVAL(Opportunity__r.Phase_Status__c , &apos;Submitted for G6 Approval&apos;))
)</errorConditionFormula>
        <errorMessage>Since Opportunity record is Locked, no operations allowed on related Deal-Opportunity Grouping records.</errorMessage>
    </validationRules>
    <validationRules>
        <fullName>RestrictUpsellOpptyAsMasterOpptyToDeal</fullName>
        <active>true</active>
        <description>Restrict the option to associate Upsell Opportunities as Master Opportunities to a Deal.</description>
        <errorConditionFormula>AND( 
$Profile.Name&lt;&gt;$Label.Data_Loader_Profile_Name, 
ISPICKVAL(Opportunity_Relation__c,&apos;Master&apos;),
ISPICKVAL(Opportunity__r.Business_Type__c,&apos;Committed Upsell&apos;),
NOT(Deal__r.RecordType.Name = &apos;Framed Deal&apos;)
)</errorConditionFormula>
        <errorMessage>Committed upsell opportunities cannot be assigned to an Upsell Deal with a master relation. Please select &apos;Subordinate&apos; or associate a standard opportunity.</errorMessage>
    </validationRules>
</CustomObject>
