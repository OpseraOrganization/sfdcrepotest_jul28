<?xml version="1.0" encoding="UTF-8"?>
<CustomObject xmlns="http://soap.sforce.com/2006/04/metadata">
    <validationRules>
        <fullName>CH_ValidAccountName</fullName>
        <active>true</active>
        <description>If the Account Name contains &quot;Nokia OYJ&quot; then it is valid account name else if contains &quot;Nokia&quot; the it is invalid</description>
        <errorConditionFormula>AND( 
NOT(OR(
$Profile.Name = &apos;System Administrator&apos;,
$Profile.Name = &apos;Data Loader Profile&apos;,
$Profile.Name = &apos;Integration API Only Profile&apos;
)),
CONTAINS(LOWER(Account.Name), LOWER($Setup.CH_AccountName__c.CH_InvalidName__c)), 
NOT(LOWER(Account.Name) = LOWER($Setup.CH_AccountName__c.CH_ValidName__c)) 
)</errorConditionFormula>
        <errorDisplayField>AccountId</errorDisplayField>
        <errorMessage>The selected account is not valid for authorization.</errorMessage>
    </validationRules>
    <validationRules>
        <fullName>Restrict_rels_to_301s_legal_entities</fullName>
        <active>true</active>
        <description>Only possible to create account-contact relationships with legal entities under the same 301</description>
        <errorConditionFormula>AND(
NOT(Account.RecordType.Name = &quot;Logistic Account&quot;), 
(
AND(
(NOT (ISNEW() &amp;&amp; IsDirect)) &amp;&amp; (NOT ISCHANGED(IsDirect)),
OR(
NOT(Account.RecordType.Name = &quot;Legal Entity&quot;),
Contact.Account.Id !=  Account.Parent.Id
)
)
)
)</errorConditionFormula>
        <errorDisplayField>AccountId</errorDisplayField>
        <errorMessage>You cannot associate a Contact with a non-legal entity or with a legal entity other than under the contacts primary account</errorMessage>
    </validationRules>
</CustomObject>
