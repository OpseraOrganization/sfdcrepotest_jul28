<?xml version="1.0" encoding="UTF-8"?>
<CustomObject xmlns="http://soap.sforce.com/2006/04/metadata">
    <validationRules>
        <fullName>CH_PreventContractNameUpdate</fullName>
        <active>true</active>
        <description>NOKIASC-34848: To prevent Users to update Contract Name, with exception to System Administrator, Data Loader Profile and Integration API Only Profile, on CARES and Vendor Service Contracts.</description>
        <errorConditionFormula>AND (
							 OR (	
												RecordType.DeveloperName = &apos;CH_ServiceContract&apos;,
												RecordType.DeveloperName = &apos;CH_VendorContract&apos;
												),
								ISCHANGED (Name),
								$Profile.Name != &apos;System Administrator&apos;,
								$Profile.Name != &apos;Data Loader Profile&apos;,
								$Profile.Name != &apos;Integration API Only Profile&apos;
)</errorConditionFormula>
        <errorDisplayField>Name</errorDisplayField>
        <errorMessage>You are not allowed to Update the Contract Name.</errorMessage>
    </validationRules>
    <validationRules>
        <fullName>CH_PreventRecordTypeUpdate</fullName>
        <active>true</active>
        <description>NOKIASC-34848: To prevent Users to update Record Type, with exception to System Administrator and Data Loader Profile, on CARES and Vendor Service Contracts.</description>
        <errorConditionFormula>AND (
							 OR (	
												RecordType.DeveloperName = &apos;CH_ServiceContract&apos;,
												RecordType.DeveloperName = &apos;CH_VendorContract&apos;
												),
								ISCHANGED (RecordTypeId),
								$Profile.Name != &apos;System Administrator&apos;,
								$Profile.Name != &apos;Data Loader Profile&apos;
)</errorConditionFormula>
        <errorMessage>You are not allowed to Update the Record Type.</errorMessage>
    </validationRules>
    <validationRules>
        <fullName>CH_PreventServiceContractCreation</fullName>
        <active>true</active>
        <description>NOKIASC-31438: To prevent DV&amp;T Team to create Service Contracts that are not Vendor Contracts.</description>
        <errorConditionFormula>AND (
				 RecordType.DeveloperName != &apos;CH_VendorContract&apos;,
				 $Permission.CH_DVTAdminstration,
				 ISNEW()
)</errorConditionFormula>
        <errorMessage>You are not allowed to Create Service Contracts from this Record Type.</errorMessage>
    </validationRules>
    <validationRules>
        <fullName>CH_ValidatePaidToEndDate</fullName>
        <active>true</active>
        <description>NOKIASC-31032: Should fire when below conditions fail:
- Vendor Contract Record Type.
- Start Date &lt; Paid End Date &lt;=  End Date.</description>
        <errorConditionFormula>AND(RecordType.DeveloperName = &apos;CH_VendorContract&apos;  
, NOT(ISBLANK(CH_PaidToEndDate__c))
, ( ( NOT( StartDate &lt; CH_PaidToEndDate__c ) &amp;&amp; NOT(ISBLANK(StartDate ))) || ( NOT( CH_PaidToEndDate__c &lt;= EndDate) &amp;&amp; (NOT(ISBLANK(EndDate )))) )
)</errorConditionFormula>
        <errorDisplayField>CH_PaidToEndDate__c</errorDisplayField>
        <errorMessage>&quot;Paid End Date&quot; cannot be prior to Start date nor later than End Date&quot;.</errorMessage>
    </validationRules>
    <validationRules>
        <fullName>CH_ValidateRenegotiationStartDate</fullName>
        <active>true</active>
        <description>NOKIASC-31033: &quot;Renegotiation Start Date&quot; cannot be prior to &quot;Start Date&quot; nor later than &quot;End Date&quot;.</description>
        <errorConditionFormula>AND( RecordType.DeveloperName = &apos;CH_VendorContract&apos; ,
NOT(ISBLANK(CH_RenegotiationStartDate__c))
,( ( NOT( StartDate &lt; CH_RenegotiationStartDate__c) &amp;&amp; NOT(ISBLANK(StartDate )))  || ( NOT( CH_RenegotiationStartDate__c &lt; EndDate ) &amp;&amp; (NOT(ISBLANK(EndDate )))) )
)</errorConditionFormula>
        <errorDisplayField>CH_RenegotiationStartDate__c</errorDisplayField>
        <errorMessage>&quot;Renegotiation Start Date&quot; cannot be prior to &quot;Start Date&quot; nor later than &quot;End Date&quot;.</errorMessage>
    </validationRules>
    <validationRules>
        <fullName>CH_ValidateStartDate</fullName>
        <active>true</active>
        <description>NOKIASC-31276: Check for Vendor Contract Record Type if &quot;Start Date&quot; is not empty.</description>
        <errorConditionFormula>AND(RecordType.DeveloperName = &apos;CH_VendorContract&apos;,
ISBLANK(StartDate ))</errorConditionFormula>
        <errorDisplayField>StartDate</errorDisplayField>
        <errorMessage>Please enter a value for the contract Start Date</errorMessage>
    </validationRules>
    <validationRules>
        <fullName>CH_ValidateVendorAccount</fullName>
        <active>true</active>
        <errorConditionFormula>AND(
				RecordType.Name =&apos;Vendor Contract&apos;,
				OR(TEXT(Account.Type) != &apos;Vendor&apos;
				,
				Account.RecordType.Name !=&apos;Legal Entity&apos;
				)
				
	)</errorConditionFormula>
        <errorMessage>The selected Account for a Vendor Contract must have Record type = Legal Entity and Type = Vendor. Please review these two fields.</errorMessage>
    </validationRules>
    <validationRules>
        <fullName>NCP_Parent_SC_must_have_Account</fullName>
        <active>true</active>
        <errorConditionFormula>AND( RecordType.DeveloperName = &apos;NCP_Parent_Service_Contract&apos;, 
     ISBLANK(AccountId)
)</errorConditionFormula>
        <errorDisplayField>AccountId</errorDisplayField>
        <errorMessage>CARES/CDB Parent Service Contract must have specified AccountId.</errorMessage>
    </validationRules>
</CustomObject>
